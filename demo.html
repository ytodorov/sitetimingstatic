<!DOCTYPE html>
<html>
<head>
    <base href="https://demos.telerik.com/kendo-ui/grid/graphql">
    <style>html { font-size: 14px; font-family: Arial, Helvetica, sans-serif; }</style>
    <title></title>
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2022.1.119/styles/kendo.default-main.min.css" />

    <script src="https://kendo.cdn.telerik.com/2022.1.119/js/jquery.min.js"></script>
    
    
    <script src="https://kendo.cdn.telerik.com/2022.1.119/js/kendo.all.min.js"></script>
    
    

</head>
<body>
    <div id="example">
    <div id="grid"></div>
    <script>
            var READ_PRODUCTS_QUERY = "query {" +
                "sites(take:5) { id, url }" +
            "}";

             var ADD_PRODUCT_QUERY = "mutation CreateProductMutation($product: ProductInput!){" +
                "createProduct(product: $product){" +
                    "productID,"+
                    "productName,"+
                    "unitPrice,"+
                    "unitsInStock"+
                "}"+
            "}";

            var UPDATE_PRODUCT_QUERY = "mutation UpdateProductMutation($product: ProductInput!){" +
                "updateProduct(product: $product){" +
                    "productID,"+
                    "productName,"+
                    "unitPrice,"+
                    "unitsInStock"+
                "}" +
            "}";

            var DELETE_PRODUCT_QUERY = "mutation DeleteProductMutation($product: ProductInput!){" +
                "deleteProduct(product: $product){" +
                    "productID,"+
                    "productName,"+
                    "unitPrice,"+
                    "unitsInStock"+
                "}"+
            "}";

            $(document).ready(function() {
                var dataSource = new kendo.data.DataSource({
                    transport: {
                        create: {
                            contentType: "application/json",
                            url: "https://demos.telerik.com/aspnet-core/service/api/graphql/",
                            type: "POST",
                            data: function(model) {
                                return {
                                    query: ADD_PRODUCT_QUERY,
                                    variables: {"product": model}
                                };
                            }
                        },
                        read: {
                            contentType: "application/json",
                            url: "https://st-westus3.azurewebsites.net/graphql",
                            type: "POST",
                            data: function() {
                                return { query: READ_PRODUCTS_QUERY };
                            }
                        },
                        update: {
                            contentType: "application/json",
                            url: "https://demos.telerik.com/aspnet-core/service/api/graphql/",
                            type: "POST",
                            data: function(model) {
                                return {
                                    query: UPDATE_PRODUCT_QUERY,
                                    variables: {"product": model}
                                };
                            }
                        },
                        destroy: {
                            contentType: "application/json",
                            url: "https://demos.telerik.com/aspnet-core/service/api/graphql/",
                            type: "POST",
                            data: function(model) {
                                return {
                                    query: DELETE_PRODUCT_QUERY,
                                    variables: {"product": model}
                                };
                            }
                        },
                        parameterMap: function(options, operation) {
                            return  kendo.stringify({
                                query: options.query,
                                variables: options.variables
                            });
                        }
                    },
                    schema: {
                        data: function(response) {
                            var data = response.data;

                            if (data.sites) { return data.sites; }
                            else if (data.createProduct) { return data.createProduct; }
                            else if (data.updateProduct) { return data.updateProduct; }
                            else if (data.deleteProduct) { return data.deleteProduct; }
                        },
                        total: function(response) {
                            return response.data.sites.length;
                        },
                        model: {
                            id: "id",
                            fields: {
                                id: { type: "number", editable: false },
                                url: { type: "string" },                            
                            }
                        }
                    },
                    pageSize: 20
                });

                $("#grid").kendoGrid({
                    dataSource: dataSource,
                    height: 550,
                    groupable: true,
                    sortable: true,
                    pageable: true,
                    toolbar: ["create"],
                    editable: "inline",
                    columns: [{
                        field: "id",
                        title: "id"
                    },
                    {
                        field: "url",
                        title: "url"
                    },                 
                    {
                        command: ["edit", "destroy"],
                        title: "Options ",
                        width: "250px"
                    }]
                });
            });
    </script>

    <script>
        var READ_PRODUCTS_QUERY = "query {" +
            "sites(take:5) { id, url }" +
        "}";

         var ADD_PRODUCT_QUERY = "mutation CreateProductMutation($product: ProductInput!){" +
            "createProduct(product: $product){" +
                "productID,"+
                "productName,"+
                "unitPrice,"+
                "unitsInStock"+
            "}"+
        "}";

        var UPDATE_PRODUCT_QUERY = "mutation UpdateProductMutation($product: ProductInput!){" +
            "updateProduct(product: $product){" +
                "productID,"+
                "productName,"+
                "unitPrice,"+
                "unitsInStock"+
            "}" +
        "}";

        var DELETE_PRODUCT_QUERY = "mutation DeleteProductMutation($product: ProductInput!){" +
            "deleteProduct(product: $product){" +
                "productID,"+
                "productName,"+
                "unitPrice,"+
                "unitsInStock"+
            "}"+
        "}";

        $(document).ready(function() {
            var dataSource = new kendo.data.DataSource({
                transport: {
                    create: {
                        contentType: "application/json",
                        url: "https://demos.telerik.com/aspnet-core/service/api/graphql/",
                        type: "POST",
                        data: function(model) {
                            return {
                                query: ADD_PRODUCT_QUERY,
                                variables: {"product": model}
                            };
                        }
                    },
                    read: {
                        contentType: "application/json",
                        url: "https://st-westus3.azurewebsites.net/graphql",
                        type: "POST",
                        data: function() {
                            return { query: READ_PRODUCTS_QUERY };
                        }
                    },
                    update: {
                        contentType: "application/json",
                        url: "https://demos.telerik.com/aspnet-core/service/api/graphql/",
                        type: "POST",
                        data: function(model) {
                            return {
                                query: UPDATE_PRODUCT_QUERY,
                                variables: {"product": model}
                            };
                        }
                    },
                    destroy: {
                        contentType: "application/json",
                        url: "https://demos.telerik.com/aspnet-core/service/api/graphql/",
                        type: "POST",
                        data: function(model) {
                            return {
                                query: DELETE_PRODUCT_QUERY,
                                variables: {"product": model}
                            };
                        }
                    },
                    parameterMap: function(options, operation) {
                        return  kendo.stringify({
                            query: options.query,
                            variables: options.variables
                        });
                    }
                },
                schema: {
                    data: function(response) {
                        var data = response.data;

                        if (data.sites) { return data.sites; }
                        else if (data.createProduct) { return data.createProduct; }
                        else if (data.updateProduct) { return data.updateProduct; }
                        else if (data.deleteProduct) { return data.deleteProduct; }
                    },
                    total: function(response) {
                        return response.data.sites.length;
                    },
                    model: {
                        id: "id",
                        fields: {
                            id: { type: "number", editable: false },
                            url: { type: "string" },                            
                        }
                    }
                },
                pageSize: 20
            });

            $("#grid").kendoGrid({
                dataSource: dataSource,
                height: 550,
                groupable: true,
                sortable: true,
                pageable: true,
                toolbar: ["create"],
                editable: "inline",
                columns: [{
                    field: "id",
                    title: "id"
                },
                {
                    field: "url",
                    title: "url"
                }]
            });
        });
</script>
</div>



    

</body>
</html>
